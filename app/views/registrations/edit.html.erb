<h1>Editar dados</h1>

<%= form_for(resource, :as => resource_name, :url => registration_path(resource_name), :html => { :method => :put }) do |f| %>
  <%= devise_error_messages! %>

  <p><%= f.label :name %><br />
  <%= f.text_field :name %></p>

  <p><%= f.label :email %><br />
  <%= f.email_field :email %></p>

  <p><%= f.label :kcal_limit %> <em><%= link_to 'Que limite usar?', 'http://www.contacal.com.br/qual-o-limite-de-calorias-indicado/', :target => '_blank' %></em>
  <%= f.text_field :kcal_limit %></p>
 
  <p>&nbsp;</p>
  <h2>Dados de cobrança</h2>

  <p><%= f.label :status %>: 
  <%- if user.status.blank? or user.status == 0 -%>
    Cortesia
  <%- elsif (user.status == 1 or user.status == 10) -%>
    Período de teste gratuito
  <%- elsif (user.status == 2 or user.status == 20) -%>
    Assinante boleto bancário
  <%- elsif (user.status == 4 or user.status == 40) -%>
    Assinante cartão de crédito
  <%- end -%>
</p>

  <%- if !user.status.blank? and (user.status == 1 or user.status == 10 or user.status == 2 or user.status == 20) and !user.expire_at.blank? -%>
  <p><%= f.label :expire_at %>: <%= user.expire_at.strftime("%d/%m/%Y") %></p>

     <p>
	   <%- if (user.status == 1 or user.status == 10) -%>
		Assinar com
	  <%- elsif (user.status == 2 or user.status == 20 or user.status == 4 or user.status == 40) -%>
	    Renovar com 
	  <%- end -%>
     <%- if !user.bank_billet_link.nil? then -%><a target=_blank href=<%= user.bank_billet_link %>> boleto</a> ou <%- end -%>
     <%- if (user.status == 1 or user.status == 2 or user.status == 4) -%>
	 <a target=_blank href=https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=AJF5XZCYGJY5A>cartão</a>.
     <%- elsif (user.status == 10 or user.status == 20 or user.status == 40) -%>
	 <a target=_blank href=https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=PEJHG3LJ2U9HC>cartão</a>.
	 <%- end -%>
  </p>

  <%- end -%>
  <p>&nbsp;</p>
  <h2>Recebimento de Emails</h2>

  <%- if (user.status == 1 or user.status == 10) -%>

  <p><b>Atenção: </b>função disponível apenas para assinantes.</p>

  <p><%= f.check_box :subscribed_daily, :disabled => true %>&nbsp;<%= f.label :subscribed_daily %></p>

  <p><%= f.check_box :subscribed_weekly, :disabled => true %>&nbsp;<%= f.label :subscribed_weekly %></p>

  <p>Esses emails serão enviados para:</p><p><b><%= user.email %></b></p>

  <p>Caso queira mandar cópia desses emails para outra pessoa (por exemplo, seu nutricionista) para que ela acompanhe seu progresso, preencha os dados abaixo:</p>

  <p><%= f.label :nutri_name %><br />
  <%= f.text_field :nutri_name, :disabled => true %></p>

  <p><%= f.label :nutri_email %><br />
  <%= f.email_field :nutri_email, :disabled => true %></p>
                                                    
  <%- else -%>

  <p><%= f.check_box :subscribed_daily %>&nbsp;<%= f.label :subscribed_daily %></p>

  <p><%= f.check_box :subscribed_weekly %>&nbsp;<%= f.label :subscribed_weekly %></p>

  <p>Esses emails serão enviados para:</p><p><b><%= user.email %></b></p>

  <p>Caso queira mandar cópia desses emails para outra pessoa (por exemplo, seu nutricionista) para que ela acompanhe seu progresso, preencha os dados abaixo:</p>

  <p><%= f.label :nutri_name %><br />
  <%= f.text_field :nutri_name %></p>

  <p><%= f.label :nutri_email %><br />
  <%= f.email_field :nutri_email %></p>
  <%- end -%>

  <p>&nbsp;</p>
  <h2>Trocar Senha</h2>

  <p><%= f.label :password %> <em>Deixe em branco para manter a atual</em>
  <%= f.password_field :password, :autocomplete => "off" %></p>

  <p><%= f.label :password_confirmation %><br />
  <%= f.password_field :password_confirmation, :autocomplete => "off" %></p>





<!--  <p><%= f.label :address_street_and_number %><br />
  <%= f.text_field :address_street_and_number %></p>

  <p><%= f.label :address_city %><br />
  <%= f.text_field :address_city %></p>

  <p><%= f.label :address_state %><br />
  <%= f.text_field :address_state %></p>

  <p><%= f.label :address_zipcode %><br />
  <%= f.text_field :address_zipcode %></p>-->

  <p><%= f.submit "Atualizar dados" %></p>
<% end %>

<!--<h3>Desativar conta</h3>-->
<p>
  <%= link_to "&laquo; voltar".html_safe, :back %>
</p>
<br />

<p id="cancel-account"><b>Quer desativar sua conta?</b>
<br /><br />
<%- if (user.status == 1 or user.status == 10) -%>
<b>Atenção: </b>mesmo que você não deseje se tornar assinante do ContaCal, não é necessário cancelar sua conta. Basta não pagar o <%- if !user.bank_billet_link.nil? then -%><a target=_blank href=<%= user.bank_billet_link %>><%- end -%>boleto</a>.<br /><br />Se mesmo assim você quiser desativar sua conta, basta você <%= link_to "clicar aqui", registration_path(resource_name), :confirm => "Tem certeza de que deseja desativar sua conta?", :method => :delete %>.<br /><br /> 
<%- elsif (user.status == 2 or user.status == 20) -%>
<b>Atenção: </b>mesmo que você não deseje renovar sua assinatura do ContaCal, não é necessário cancelar sua conta. Basta não pagar o <%- if !user.bank_billet_link.nil? then -%><a target=_blank href=<%= user.bank_billet_link %>><%- end -%>boleto</a>.<br /><br />Se mesmo assim você quiser desativar sua conta, basta você <%= link_to "clicar aqui", registration_path(resource_name), :confirm => "Tem certeza de que deseja desativar sua conta?", :method => :delete %>.<br /><br /> 
<%- elsif (user.status == 4 or user.status == 40) -%>
<b>Atenção: </b>como você é assinante via cartão de crédito, você precisa acessar o <a href=http://paypal.com>PayPal</a> para cancelar os pagamentos.<br /><br /> 
<%- else -%>
Apesar de ficarmos muito tristes por você não querer mais usar o ContaCal, respeitamos sua decisão. Para desativar sua conta, basta você <%= link_to "clicar aqui", registration_path(resource_name), :confirm => "Tem certeza de que deseja desativar sua conta?", :method => :delete %>.
<%- end -%>
</p>	
